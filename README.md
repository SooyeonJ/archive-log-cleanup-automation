# Archive Log Cleanup Automation

아카이브 로그 누적으로 인한 디스크 사용률 증가 문제 해결을 목적으로  
최근 2주(14일) 기준 아카이브 로그를 정리하는 자동화 작업 수행

본 작업은 Shell Script와 CRON을 활용한 정기 실행 방식으로 구성되며,  
운영 중인 DB 서비스에 영향 없이 로그 정리 수행을 통해  
디스크 사용률 감소 및 장애 발생 가능성 최소화를 목표로 함

---

## 목표

아카이브 로그 장기 누적으로 인해  
`/data` 파일시스템 사용률이 약 **52% (773GB)** 수준까지 증가한 상황에서 아래 목표 수행

- 디스크 사용률을 안정적인 수준으로 회복
- 불필요한 로그 정리를 자동화
- 디스크 Full로 인한 DB 서비스 장애 예방

---

## 수행 작업

- 아카이브 로그 누적 현황 점검 스크립트 수행
- 최근 2주(14일) 초과 로그 삭제 기준 정의
- Shell Script 기반 아카이브 로그 정리 자동화 구현
- CRON을 활용한 매일 07:00 정기 실행 구성
- 삭제 전/후 디스크 사용량(`df -h`, `du -sh`) 비교를 통한 정량적 검증 수행

---

## 개요

| 구분 | 내용 |
|----|----|
| 대상 | DB 아카이브 로그 (Archive Log) |
| 문제 | 로그 누적으로 인한 디스크 사용률 증가 |
| 해결 | 2주(14일) 초과 로그 자동 삭제 |
| 방식 | Shell Script + CRON |
| 실행 시간 | 매일 07:00 |
| 서비스 영향 | DB 재기동 없음 |

---

## 문제 정의

DB는 ARCHIVELOG 모드로 운영 중이며,  
트랜잭션 발생에 따라 아카이브 로그가 지속적으로 생성되는 구조

장기간 로그 정리가 수행되지 않아  
`/data` 파일시스템 기준 디스크 사용량이 약 **773GB**,  
사용률이 약 **52%** 수준까지 증가한 상태 확인

이로 인해 하기 문제 발생 가능성 존재
- 디스크 Full 상황 발생 가능성 증가
- DB 서비스 장애 위험 증가
- 긴급 수동 로그 정리 작업 발생 가능성
- 운영 안정성 저하

---

## 해결 방안

| 항목 | 적용 내용 |
|----|----|
| 사전 점검 | 아카이브 로그 개수 및 기간 분포 확인 |
| 삭제 정책 | 최근 2주(14일) 초과 로그 삭제 |
| 자동화 | CRON 기반 정기 실행 |
| 안정성 | DB 재기동 없이 로그 정리 수행 |
| 검증 | 삭제 전/후 디스크 사용량 수치 비교 |

아카이브 로그 중,  
업무적으로 필요성이 낮은 **14일 초과 로그를 삭제 대상**으로 설정하여  
디스크 사용량을 단계적으로 감소시키는 방식 적용

---

## 보관 및 백업 정책

### Archive Log Retention

| 항목 | 내용 |
|----|----|
| 보관 기간 | 14일 |
| 삭제 기준 | 파일 수정 시간(mtime) |
| 삭제 대상 | 14일 초과 아카이브 로그 |

### 백업 정책

- 아카이브 로그 및 데이터 백업은 클라우드 환경에서 제공하는 백업 정책을 기준으로 수행
- 본 자동화 작업은 백업 완료 이후 생성된 로그에 대해서만 정리 수행
- 백업 안정성 확보 이후 디스크 공간 정리를 통한 운영 효율성 향상

---

## CRON 스케쥴

```bash
0 7 * * * /path/to/archive_cleanup.sh >> /path/to/archive_cleanup_cron.log 2>&1
